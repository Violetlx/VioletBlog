<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><!-- hexo injector head_begin start --><link href="https://cdn.jsdelivr.net/npm/hexo-widget-tree@0.2.3/css/index.css" rel="stylesheet"><!-- hexo injector head_begin end --><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>Nacos 安装与使用 | Violet博客屋</title><meta name="keywords" content="nacos"><meta name="author" content="violet"><meta name="copyright" content="violet"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="Nacos 安装与使用"><meta name="application-name" content="Nacos 安装与使用"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="Nacos 安装与使用"><meta property="og:url" content="http://example.com/posts/95afb97c.html"><meta property="og:site_name" content="Violet博客屋"><meta property="og:description" content="Nacos 安装与使用"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://cdn.apifox.cn/app/project-icon/custom/20221110/b67baa75-a01e-49c3-81fc-da1f2982343a.jpeg"><meta property="article:author" content="violet"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.apifox.cn/app/project-icon/custom/20221110/b67baa75-a01e-49c3-81fc-da1f2982343a.jpeg"><meta name="description" content="Nacos 安装与使用"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/posts/95afb97c"><link rel="preconnect" href="//cdn.cbd.int"><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="google-site-verification" content="xxx"><meta name="baidu-site-verification" content="code-xxx"><meta name="msvalidate.01" content="xxx"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="var(--anzhiyu-main)"><link rel="mask-icon" href="/img/siteicon/apple-icon-180.png" color="#5bbad5"><link rel="apple-touch-icon" sizes="180x180" href="/img/siteicon/apple-icon-180.png"><link rel="apple-touch-icon-precomposed" sizes="180x180" href="/img/siteicon/apple-icon-180.png"><link rel="icon" type="image/png" sizes="32x32" href="/img/siteicon/32.png"><link rel="icon" type="image/png" sizes="16x16" href="/img/siteicon/16.png"><link rel="bookmark" href="/img/siteicon/apple-icon-180.png"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2048-2732.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2732-2048.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1668-2388.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2388-1668.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1536-2048.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2048-1536.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1668-2224.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2224-1668.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1620-2160.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2160-1620.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1290-2796.jpg" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2796-1290.jpg" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1179-2556.jpg" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2556-1179.jpg" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1284-2778.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2778-1284.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1170-2532.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2532-1170.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1125-2436.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2436-1125.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1242-2688.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2688-1242.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-828-1792.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1792-828.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1242-2208.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2208-1242.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-750-1334.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1334-750.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-640-1136.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1136-640.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: undefined,
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: {"mode":"api","api":"https://img2color-go.vercel.app/api?img=","cover_change":true},
  authorStatus: {"skills":["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🏠 智能家居小能手","🔨 设计开发一条龙","🤝 专修交互与设计","🏃 脚踏实地行动派","🧱 团队小组发动机","💢 壮汉人狠话不多"]},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":1500,"languages":{"author":"作者: violet","link":"链接: ","source":"来源: Violet博客屋","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'mediumZoom',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'Violet博客屋',
  title: 'Nacos 安装与使用',
  postAI: '',
  pageFillDescription: '概述, 服务注册与发现, 配置管理, Nacos 概述, 快速开始, 安装 Nacos Server, 接入云上免费版本, 本地安装方式, 接入 Nacos 配置中心, 接入 Nacos Config, 添加 Nacos 配置, 启动应用并验证, 接入 Nacos 服务注册与发现, 接入 Nacos Discovery, 启动应用并验证, 服务消费, 应用配置, 验证, 进阶指南, Nacos 配置中心进阶指南, profile 粒度配置, 自定义 Namespace 的配置, 自定义 Group 的配置, 配置的优先级, springc.config.import 引入, 配置项参考, Endpoint 信息, Nacos 服务注册与发现进阶指南, 原理, IPv4 至 IPv6 地址迁移方案, 配置项参考, Endpoint 信息概述服务注册与发现微服务与传统单体式应用架构最大区别就是强调软件模块的拆分在单体架构下一个应用系统的多个功能模块由于组织在一起在同一个应用进程内部署与运行因此模块之间直接通过方法调用即可完成对一次请求得响应但在微服务系统中需要对一个应用系统根据其功能特点按照一定粒度进行拆分后单独部署以便实现模块内的高内聚模块间的低耦合实现整个微服务系统的高可扩展性原来一次在一个应用内即可完成的请求处理会出现跨进程跨主机的微服务调用如何让这个服务之间能够互相发现像单体式应用一样提供统一对外的服务调用能力式微服务框架层面需要重点解决的核心问题之一在生态中采用了如下服务注册与发现模型来实现微服务之间的相互发现与调用如上图所示通过在微服务系统中引入一个叫做注册中心的组件来作为协调者其最简化的过程是所有的微服务应用在启动过程中会将自身包含服务名称主机地址和端口号等信息发送到注册中心中然后上游的微服务在处理请求过程中根据服务名称到注册中心查找对应服务的所有实例地址和端口号来进行服务调用整个过程中如图中虚线所示从而让分散的微服务系统之间能够像一个整体一样对外提供请求处理能力配置管理在正式介绍分布式配置内容之前还是先简单介绍一下配置的概念软件系统中的配置是指在软件运行过程中所需要的各种设定和参数包括系统配置应用配置和用户配置等系统配置包括操作系统硬件和网络等基本环境参数的设定应用配置包括应用程序的各种参数和选项的设定如数据库连接字符串日志级别等用户配置则是指用户自定义的各种选项和参数如快捷键界面布局语言等配置在软件系统中是对软件源代码的一种重要补充通过其可以便捷的调整软件系统的执行行为让软件系统更加灵活除了单体应用在分布式系统中配置信息应用非常广泛可以通过配置来实现不同的功能这些配置信息如数据库连接信息日志级别业务配置等等在传统的开发中这些配置西南西通常硬编码到应用程序的代码中与程序代码一起打包和部署然而这种方式有很多缺点比如配置不易维护只要修改配置就得重新构建和部署等采用分布式配置中心的软件架构如上图所示其可以在分布式场景中帮助解决以下问题管理应用程序配置当有大量应用程序需要管理时手动维护配置文件会变得非常困难分布式配置中心提供了一个集中管理和分发配置信息的解决方案环境隔离在开发测试和生产等不同环境中应用程序的配置信息往往都会有不同使用分布式配置中心可以轻松管理和分发不同环境下的配置信息提高程序安全性将配置信息存储在代码库或应用程序文件中可能会导致安全风险因为这些信息可能会被意外地泄露或被恶意攻击者利用使用分布式配置可以将配置信息加密和保护并且可以进行访问权限控制动态更新配置在应用程序运行时可能需要动态地更新配置信息以便应用程序可以及时响应变化使用分布式配置中心可以在运行时动态更新配置信息而无需重新启动应用程序概述是的首字母简称一个更易于构建云原生应用的动态服务发现配置管理和服务管理平台致力于帮助发现配置和管理微服务提供了一组简单易用的特性集帮助你快速实现动态服务发现服务配置服务元数据及流量管理可以更敏捷和更容易地构建交付和管理微服务平台是构建以服务为中心的现代应用架构例如微服务范式云原生范式的服务基础设施快速开始使用和完成应用的配置管理和服务发现安装接入云上免费版本体验注册配置中心的最简单方式就是接入阿里云上的托管这样可以免去本地安装下载的繁琐步骤具体参考如何体验和接入阿里云托管免费如果是用的云上托管版本在接下来的文档使用云上地址替换即可本地安装方式具体启动方式参考官网启动成功之后浏览器地址栏输入查看控制台默认账号名称和密码为关于更多的版本可以从官方页面查看接入配置中心接入如果在你的项目中使用来实现配置管理需要进行以下操作确保已启动需要在文件中引入为和为的在应用的配置文件中配置地址并引入服务配置如果用的云上托管版本输入可访问的地址即可完成上述两步后应用会从中获取相应的配置并添加在的中假设我们通过作为配置中心保存应用服务的部分配置有以下几种方式实现通过将配置信息配置给支持配置变自动刷新监听配置信息对接接口通过接口完成对配置信息增删改查通过注解进行配置信息获取添加配置命令方式控制台方式推荐使用为为配置内容如下启动应用并验证应用启动添加其他配置在应用的中添加基本配置信息启动应用支持直接启动和编译打包后启动直接启动找到主类执行方法启动应用打包编译后启动首先执行将工程编译打包然后执行启动应用功能验证验证自动注入请求地址可以看到成功从配置中心中获取了数据响应结果验证动态刷新在命令行终端执行以下命令刷新的配置信息再次请求地址可以看到应用已经从中获取到了最新的数据响应结果配置管理示例源码参考配置管理示例接入服务注册与发现接入如果要在你的项目中使用来作为服务发现的组件需要进行以下操作确保已启动需要在文件中引入为和为的添加应用配置在应用的配置文件中配置地址使用注解开启服务注册与发现功能启动应用并验证应用启动添加配置在项目的中添加基本配置信息启动应用支持直接启动和编译打包后启动直接启动找到项目的主类执行方法启动应用打包编译后启动在项目中执行将工程编译打包然后执行启动应用验证查询服务使用终端输入如下命令查询可以看到服务节点已经成功注册到响应结果服务发现在中加入以下依赖在配置文件中加入以下配置服务消费应用配置本章节只是为了便于您理解接入方式此处只涉及相关内容如果已经使用了其他服务发现组件可以通过直接替换依赖来接入添加注解使得接入已经默认集成了此处演示如何配置一个使用注解将这个接口包装成一个属性对应服务名方法上的注解将方法与相对应注解将路径中的对应成方法的参数将两者注入到中添加必要的配置在项目的中添加基本配置信息启动应用直接启动找到项目的主类执行方法启动应用打包编译后启动在项目中执行将工程编译打包然后执行启动应用验证请求地址可以看到响应显示了返回的消息证明服务发现生效响应结果请求地址可以看到响应显示了返回的消息证明服务发现生效响应结果服务注册与发现示例源码参考服务注册与发现示例进阶指南本章节展示和的高级特性和进阶用法配置中心进阶指南粒度配置在加载服务配置时不仅仅加载了以为为前缀的基础配置还加载了为的基础配置在日常开发中如果遇到多套环境下的不同配置可以通过提供的这个配置项选择不同情况下的配置上新增一个为的基础配置如下所示配置格式配置内容启动应用测试的代码如下获取当前部署的环境控制台输出结果如下如果需要切换到生产环境只需要更改参数配置即可如下所示同时生产环境上需要添加对应的基础配置例如在生成环境下的添加了为的配置配置格式配置内容启动测试程序输出结果如下此案例中我们通过的方式写死在配置文件中而在真正的项目实施过程中这个变量的值是需要不同环境而有不同的值这个时候通常的做法是通过参数指定其配置来达到环境间灵活的切换自定义的配置内部有的概念用于进行租户粒度的配置隔离不同的命名空间下可以存在相同的或的配置的常用场景之一是不同环境的配置的区分隔离例如开发测试环境和生产环境的资源如配置服务隔离等在没有明确指定配置的情况下默认使用的是中命名空间即默认的命名空间如果需要使用自定义的命名空间可以通过以下配置来实现该配置必须放在文件中此外的值是对应的值可以在的控制台获取并且在添加配置时注意不要选择其他的否则将会导致读取不到正确的配置自定义的配置在没有明确指定配置的情况下默认使用的是组如果需要自定义可以通过以下配置来实现该配置必须放在文件中并且在添加配置时的值一定要和的配置值一致配置的优先级目前提供了三种配置能力从拉取相关的配置通过支持多个共享的配置通过的方式支持多个扩展的配置通过内部相关规则应用名应用名自动生成相关的配置当三种方式共同使用时他们的一个优先级关系是引入这里假设有一个配置文件升级到以上的版本应该怎么配置呢注意上面的配置和下面的配置是等价的监听覆盖默认监听不开启动态刷新在拉取配置异常时会快速失败会导致容器启动失败使用引入配置时的注意事项如下如果使用就不能使用引入配置的方式了如果引入了并且使用方式导入配置项目启动时会自动检测是否引入了条目如果没有条目会出现如下错误可以通过手动设置关闭它但是不建议这么做这个功能可以帮助你检查是否引入多余依赖假如想保留以前的使用方式引入配置你只需要添加依赖依赖不需要修改一行代码即可完成配置方式的切换配置项参考更多关于的配置项如下所示配置项默认值说明服务端地址服务器和端口前缀的前缀默认值为应用名称后缀及内容文件格式的后缀同时也是配置内容的文件格式目前只支持配置内容的编码方式配置的编码获取配置的超时时间单位为配置的命名空间常用场景之一是不同环境的配置的区分隔离例如开发测试环境和生产环境的资源隔离等相对路径服务端的相对路径接入点地域的某个服务的入口域名通过此域名可以动态地拿到服务端地址是否开启监听和自动刷新集群服务名信息请求地址可以看到相关的节点信息响应结果服务注册与发现进阶指南原理遵循了标准实现了这三个接口在应用的启动阶段监听了事件当容器初始化完成后即收到事件后会触发注册的动作调用的方法将服务注册到至地址迁移方案和地址双注册在配置完成作为负载均衡策略后应用启动后会默认将微服务的地址和地址注册到注册中心中其中地址会存放在服务列表中的字段下地址在的字段中其对应的为当服务消费者调用服务提供者时会根据自身的地址栈支持情况选择合适的地址类型发起服务调用具体规则服务消费者本身支持和双地址栈或仅支持地址栈的情况下服务消费者会使用服务提供的地址发起服务调用地址调用失败且服务本身同时支持地址栈时暂不支持切换到地址发起重试调用服务消费者本身仅支持单地址栈的情况下服务消费者会使用服务提供的地址发起服务调用仅注册如果您只想使用地址进行注册可以在使用如下配置项进行配置仅注册如果您只想使用地址可以在使用如下配置项进行配置配置项参考更多关于的配置项如下所示配置项默认值说明服务端地址服务名应用名注册到上的服务名称默认值为应用名称权重取值范围到数值越大权重越大网卡名当未配置时注册的为此网卡所对应的地址如果此项也未配置则默认取第一块网卡的地址注册的地址优先级最高注册的地址类型双栈地址可以配置和两种类型如果网卡同类型地址存在多个希望制定特定网段地址可使用配置筛选地址注册的端口默认情况下不用配置会自动探测命名空间常用场景之一是不同环境的注册的区分隔离例如开发测试环境和生产环境的资源如配置服务隔离等使用格式配置日志文件名集群集群名称接入点地域的某个服务的入口域名通过此域名可以动态地拿到服务端地址是否集成是否开启可以设置成来开启是否启用默认启动设置为时会关闭自动向注册的功能是否启用容错配置开启服务发现失败容错能力该功能会在获取实例失败时返回上一次获取的实例可以在网络不稳定时提供容错能力不会导致请求全部挂掉信息请求地址可以看到相关的节点信息响应结果',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-09-29 17:11:27',
  postMainColor: '#cbcbcc',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/xxx.css?1"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-swiper/swiper/swiper.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-swiper/swiper/swiperstyle.css"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="/img/basic/avatar.png"><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://violet.zeabur.app/" title="博客"><img class="back-menu-item-icon" src="/img/favicon.ico" alt="博客"><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/" title="Github"><img class="back-menu-item-icon" src="https://pic4.zhimg.com/v2-341e1d3b2845db15bceeff70d3fe228b_r.jpg" alt="Github"><span class="back-menu-item-text">Github</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">Violet博客屋</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 博文</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 生活</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/shuoshuo/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 分享</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/photos/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/music/?id=1994908354&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/movies/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 影视</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/games/"><i class="anzhiyufont anzhiyu-icon-rocket faa-tada" style="font-size: 0.9em;"></i><span> 游戏厅</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 我的装备</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/collects/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 足迹</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/treasures/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 藏宝阁</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文档</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-book faa-tada" style="font-size: 0.9em;"></i><span> 随机文章</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/document/"><i class="anzhiyufont anzhiyu-icon-book faa-tada" style="font-size: 0.9em;"></i><span> 文档页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/itbaima/"><i class="anzhiyufont anzhiyu-icon-book faa-tada" style="font-size: 0.9em;"></i><span> 柏码</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/runoob/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 菜鸟教程</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/itheima/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 黑马程序员</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/SpringCloudAlibaba/"><i class="anzhiyufont anzhiyu-icon-book faa-tada" style="font-size: 0.9em;"></i><span> 阿里微服务</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友人帐</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友链</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 网站导航</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/front/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 前端</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/back-end/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 后端</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/programmer/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 程序员</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/ai/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> AI</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/about/"><span> 关于笔者</span></a></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://c-ssl.dtstatic.com/uploads/blog/202304/15/20230415081411_9a88c.thumb.400_0.jpg" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://c-ssl.dtstatic.com/uploads/blog/202304/15/20230415081411_9a88c.thumb.400_0.jpg"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://tupian.qqw21.com/article/UploadPic/2020-6/20206416212275003.jpg" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://tupian.qqw21.com/article/UploadPic/2020-6/20206416212275003.jpg"></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">音乐</div><span class="author-content-item-title">灵魂的碰撞💥</span></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">十月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">九月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">19</span><span>篇</span></div></a></li></ul></div><hr></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" itemprop="url">环境搭建</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/nacos/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>nacos</span></a></span></div></div><h1 class="post-title" itemprop="name headline">Nacos 安装与使用</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-09-24T09:00:26.000Z" title="发表于 2024-09-24 17:00:26">2024-09-24</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-09-29T09:11:27.788Z" title="更新于 2024-09-29 17:11:27">2024-09-29</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">6.8k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>27分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="Nacos 安装与使用"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为长沙"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>长沙</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://cdn.apifox.cn/app/project-icon/custom/20221110/b67baa75-a01e-49c3-81fc-da1f2982343a.jpeg"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope="" itemtype="http://example.com/posts/95afb97c.html"><header><a class="post-meta-categories" href="/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" itemprop="url">环境搭建</a><a href="/tags/nacos/" tabindex="-1" itemprop="url">nacos</a><h1 id="CrawlerTitle" itemprop="name headline">Nacos 安装与使用</h1><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">violet</span><time itemprop="dateCreated datePublished" datetime="2024-09-24T09:00:26.000Z" title="发表于 2024-09-24 17:00:26">2024-09-24</time><time itemprop="dateCreated datePublished" datetime="2024-09-29T09:11:27.788Z" title="更新于 2024-09-29 17:11:27">2024-09-29</time></header><p><img src="/img/load.gif" data-original="https://pic2.zhimg.com/v2-71daae9a4aef25ce7a01606571b2365a_r.jpg" alt=" https://pic2.zhimg.com/v2-71daae9a4aef25ce7a01606571b2365a_r.jpg"></p>
<h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><h2 id="服务注册与发现"><a href="#服务注册与发现" class="headerlink" title="服务注册与发现"></a>服务注册与发现</h2><p>微服务与传统单体式应用架构最大区别就是强调软件模块的拆分。在单体架构下，一个应用系统的多个功能模块由于组织在一起在同一个应用进程内部署与运行，因此，模块之间直接通过方法调用即可完成对一次请求得响应。但在微服务系统中需要对一个应用系统根据其功能特点，按照一定粒度进行拆分后单独部署，以便实现模块内的高内聚，模块间的低耦合，实现整个微服务系统的高可扩展性。原来一次在一个应用内即可完成的请求处理，会出现跨进程跨主机的微服务调用，如何让这个服务之间能够互相发现像单体式应用一样提供统一对外的服务调用能力式微服务框架层面需要重点解决的核心问题之一。</p>
<p>在 Spring Cloud 生态中，采用了如下服务注册与发现模型，来实现微服务之间的相互发现与调用。</p>
<p><img src="/img/load.gif" data-original="https://sca.aliyun.com/img/user/quickstart/nacos/service-discovery.png" alt="服务注册与发现模型"></p>
<p>如上图所示，通过在微服务系统中引入一个叫做注册中心的组件，来作为协调者。其最简化的过程是，所有的微服务应用在启动过程中会将自身包含服务名称、主机 IP 地址和端口号等信息发送到注册中心中，然后上游的微服务在处理请求过程中，根据服务名称到注册中心查找对应服务的所有实例 IP 地址和端口号来进行服务调用，整个过程中如图中虚线所示。从而让分散的微服务系统之间能够像一个整体一样对外提供请求处理能力。</p>
<h2 id="配置管理"><a href="#配置管理" class="headerlink" title="配置管理"></a>配置管理</h2><p>在正式介绍分布式配置内容之前，还是先简单介绍一下配置的概念。</p>
<p>软件系统中的配置是指在软件运行过程中所需要的各种设定和参数，包括系统配置、应用配置和用户配置等。</p>
<ul>
<li>系统配置包括操作系统、硬件和网络等基本环境参数的设定</li>
<li>应用配置包括应用程序的各种参数和选项的设定，如数据库连接字符串、日志级别等</li>
<li>用户配置则是指用户自定义的各种选项和参数，如快捷键、界面布局、语言等</li>
</ul>
<p>配置在软件系统中是对软件源代码的一种重要补充，通过其可以便捷的调整软件系统的执行行为，让软件系统更加灵活。</p>
<p>除了单体应用，在分布式系统中，配置信息应用非常广泛，可以通过配置来实现不同的功能。这些配置信息如数据库连接信息、日志级别、业务配置等等。</p>
<p>在传统的开发中，这些配置西南西通常硬编码到应用程序的代码中，与程序代码一起打包和部署。然而，这种方式有很多缺点，比如配置不易维护，只要修改配置就得重新构建和部署等。</p>
<p><img src="/img/load.gif" data-original="https://sca.aliyun.com/img/user/quickstart/nacos/spring-cloud-config.png" alt="service-config"></p>
<p>采用分布式配置中心的软件架构如上图所示，其可以在分布式场景中帮助解决以下问题：</p>
<ol>
<li>管理应用程序配置：当有大量应用程序需要管理时，手动维护配置文件会变得非常困难。分布式配置中心提供了一个集中管理和分发配置信息的解决方案。</li>
<li>环境隔离：在开发、测试和生产等不同环境中，应用程序的配置信息往往都会有不同。使用分布式配置中心，可以轻松管理和分发不同环境下的配置信息。</li>
<li>提高程序安全性：将配置信息存储在代码库或应用程序文件中可能会导致安全风险，因为这些信息可能会被意外地泄露或被恶意攻击者利用。使用分布式配置，可以将配置信息加密和保护，并且可以进行访问权限控制。</li>
<li>动态更新配置：在应用程序运行时，可能需要动态地更新配置信息，以便应用程序可以及时响应变化。使用分布式配置中心，可以在运行时动态更新配置信息，而无需重新启动应用程序。</li>
</ol>
<h2 id="Nacos-概述"><a href="#Nacos-概述" class="headerlink" title="Nacos 概述"></a>Nacos 概述</h2><p><a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9uYWNvcy5pby96aC1jbi8=">Nacos</a> /nɑ:k əʊs/ 是 Dynamic Naming and Configuration Service 的首字母简称，一个更易于构建云原生应用的动态服务发现、配置管理和服务管理平台。</p>
<p>Nacos 致力于帮助发现、配置和管理微服务。Nacos 提供了一组简单易用的特性集，帮助你快速实现动态服务发现、服务配置、服务元数据及流量管理。</p>
<p>Nacos 可以更敏捷和更容易地构建、交付和管理微服务平台。Nacos 是构建以 <strong>服务</strong> 为中心的现代应用架构（例如微服务范式、云原生范式）的服务基础设施。</p>
<hr>
<h1 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a>快速开始</h1><p>使用 <code>spring-cloud-starter-alibaba-nacos-config</code> 和 <code>spring-cloud-starter-alibaba-nacos-discovery</code> 完成 Spring Cloud 应用的配置管理和服务发现。</p>
<h2 id="安装-Nacos-Server"><a href="#安装-Nacos-Server" class="headerlink" title="安装 Nacos Server"></a>安装 Nacos Server</h2><h3 id="接入云上免费版本"><a href="#接入云上免费版本" class="headerlink" title="接入云上免费版本"></a>接入云上免费版本</h3><p>体验 Spring Cloud Alibaba 注册配置中心的最简单方式就是接入阿里云上的托管 Nacos Server ，这样可以免去本地安装下载的繁琐步骤。具体参考 <a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9mcmVlLmFsaXl1bi5jb20vP3NlYXJjaEtleT1uYWNvcyZzcG09c2NhLXF1aWNrc3RhcnQtZnJlZS50b3BiYXIuMC4wLjA=">如何体验和接入阿里云托管免费 Nacos Server</a>。</p>
<blockquote>
<p>如果是用的云上托管版本 Nacos Server ，在接下来的文档使用 云上 <code>Nacos Server</code> 地址 替换 <code>127.0.0.1:8848</code> 即可。</p>
</blockquote>
<h3 id="本地安装方式"><a href="#本地安装方式" class="headerlink" title="本地安装方式"></a>本地安装方式</h3><p>具体启动方式参考 <a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9uYWNvcy5pby96aC1jbi9kb2NzL3F1aWNrLXN0YXJ0Lmh0bWw=">Nacos</a> 官网。</p>
<p>Nacos Server 启动成功之后，浏览器地址栏输入 <code>http://ip:8848/nacos</code> 查看 Nacos 控制台（默认账号名称和密码为 nacos/nacos）：</p>
<p><img src="/img/load.gif" data-original="https://sca.aliyun.com/img/user/quickstart/nacos/nacos-config-dashboard.png" alt="nacos-server-start"></p>
<p>关于更多的 Nacos Server 版本，可以从 Nacos 官方 <a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2FsaWJhYmEvbmFjb3MvcmVsZWFzZXM=">release</a> 页面查看。</p>
<h2 id="接入-Nacos-配置中心"><a href="#接入-Nacos-配置中心" class="headerlink" title="接入 Nacos 配置中心"></a>接入 Nacos 配置中心</h2><h3 id="接入-Nacos-Config"><a href="#接入-Nacos-Config" class="headerlink" title="接入 Nacos Config"></a>接入 Nacos Config</h3><p>如果在你的项目中使用 Nacos 来实现配置管理，需要进行以下操作（确保 Nacos Server 已启动）：</p>
<ol>
<li><p>需要在 pom.xml 文件中引入 group ID 为 com.alibaba.cloud 和 atrfact ID 为 spring-cloud-starter-alibaba-nacos-config 的 starter:</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>在应用的 /src/main/resources/application.yaml 配置文件中配置 Nacos Config 地址并引入服务配置：</p>
<figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">serverAddr:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:8848</span> <span class="comment">#如果用的云上托管版本，输入可访问的Nacos Server地址即可</span></span><br><span class="line">  <span class="attr">config:</span></span><br><span class="line">    <span class="attr">import:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">nacos:nacos-config-example.properties?refreshEnabled=true</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>完成上述两步后，应用会从 Nacos Server 中获取相应的配置，并添加在 Spring Environment 的 PropertySources 中。假设我们通过 Nacos 作为配置中心保存应用服务的部分配置，有以下几种方式实现：</p>
<ul>
<li>BeanAutoRefreshConfigExample：通过将配置信息配置给 bean ，支持配置变自动刷新；</li>
<li>ConfigListenerExample：监听配置信息；</li>
<li>DockingInterfaceExample：对接 Nacos 接口，通过接口完成对配置信息增删改查；</li>
<li>ValueAnnotationExample：通过 @Value 注解进行配置信息获取。</li>
</ul>
</li>
</ol>
<h3 id="添加-Nacos-配置"><a href="#添加-Nacos-配置" class="headerlink" title="添加 Nacos 配置"></a>添加 Nacos 配置</h3><ol>
<li><p>命令方式：</p>
<figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line">$ curl -X POST <span class="string">"http://127.0.0.1:8848/nacos/v1/cs/configs?dataId=nacos-config-example.properties&amp;group=DEFAULT_GROUP&amp;content=spring.cloud.nacos.config.serverAddr=127.0.0.1:8848%0Aspring.cloud.nacos.config.prefix=PREFIX%0Aspring.cloud.nacos.config.group=GROUP%0Aspring.cloud.nacos.config.namespace=NAMESPACE"</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>控制台方式（推荐使用）</p>
<figure class="highlight properties"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">dataId</span> <span class="string">为：nacos-config-example.properties</span></span><br><span class="line"><span class="attr">group</span> <span class="string">为：DEFAULT_GROUP</span></span><br></pre></td></tr></tbody></table></figure>
<p>配置内容如下：</p>
<figure class="highlight properties"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">spring.cloud.nacos.config.serveraddr</span>=<span class="string">127.0.0.1:8848</span></span><br><span class="line"><span class="attr">spring.cloud.nacos.config.prefix</span>=<span class="string">PREFIX</span></span><br><span class="line"><span class="attr">spring.cloud.nacos.config.group</span>=<span class="string">GROUP</span></span><br><span class="line"><span class="attr">spring.cloud.nacos.config.namespace</span>=<span class="string">NAMESPACE</span></span><br></pre></td></tr></tbody></table></figure>
</li>
</ol>
<h3 id="启动应用并验证"><a href="#启动应用并验证" class="headerlink" title="启动应用并验证"></a>启动应用并验证</h3><p><strong>应用启动</strong></p>
<ol>
<li><p>添加其他配置：在应用的 src/main/resources/application.yaml 中添加基本配置信息：</p>
<figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">18084</span></span><br><span class="line"><span class="attr">management:</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">      <span class="attr">exposure:</span></span><br><span class="line">        <span class="attr">include:</span> <span class="string">"*"</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>启动应用，支持 IDE 直接启动和编译打包后启动。</p>
<ul>
<li>IDE 直接启动：找到主类 NacosConfigApplication ，执行 main 方法启动应用。</li>
<li>打包编译后启动：首先执行 mvn clean package 将工程编译打包，然后执行 java-jar nacos-config-example.jar 启动应用。</li>
</ul>
</li>
</ol>
<p><strong>功能验证</strong></p>
<ol>
<li><p>验证自动注入</p>
<p>请求 <a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cDovLzEyNy4wLjAuMToxODA4NC9uYWNvcy9iZWFu">http://127.0.0.1:18084/nacos/bean</a> 地址，可以看到成功从 Nacos 配置中心中获取了数据。</p>
<figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line">$ curl http://127.0.0.1:18084/nacos/bean</span><br></pre></td></tr></tbody></table></figure>
<p>响应结果：</p>
<figure class="highlight json"><table><tbody><tr><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">"serverAddr"</span><span class="punctuation">:</span> <span class="string">"127.0.0.1:8848"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">"prefix"</span><span class="punctuation">:</span> <span class="string">"PREFIX"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">"namespace"</span><span class="punctuation">:</span> <span class="string">"NAMESPACE"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">"group"</span><span class="punctuation">:</span> <span class="string">"GROUP"</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>验证动态刷新</p>
<p>在命令行终端执行以下命令刷新 Nacos 的配置信息：</p>
<figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line">$ curl -X POST <span class="string">"http://127.0.0.1:8848/nacos/v1/cs/configs?dataId=nacos-config-example.properties&amp;group=DEFAULT_GROUP&amp;content=spring.cloud.nacos.config.serveraddr=127.0.0.1:8848%0Aspring.cloud.nacos.config.prefix=PREFIX%0Aspring.cloud.nacos.config.group=DEFAULT_GROUP%0Aspring.cloud.nacos.config.namespace=NAMESPACE"</span></span><br></pre></td></tr></tbody></table></figure>
<p>再次请求 <a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cDovLzEyNy4wLjAuMToxODA4NC9uYWNvcy9iZWFu">http://127.0.0.1:18084/nacos/bean</a> 地址，可以看到应用已经从 Nacos 中获取到了最新的数据。</p>
<figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line">$ curl http://127.0.0.1:18084/nacos/bean</span><br></pre></td></tr></tbody></table></figure>
<p>响应结果：</p>
<figure class="highlight json"><table><tbody><tr><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line">  <span class="attr">"serverAddr"</span><span class="punctuation">:</span> <span class="string">"127.0.0.1:8848"</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"prefix"</span><span class="punctuation">:</span> <span class="string">"PREFIX"</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"namespace"</span><span class="punctuation">:</span> <span class="string">"NAMESPACE"</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"group"</span><span class="punctuation">:</span> <span class="string">"DEFAULT_GROUP"</span></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure>
<p>Nacos 配置管理示例源码参考：<a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2FsaWJhYmEvc3ByaW5nLWNsb3VkLWFsaWJhYmEvdHJlZS8yMDIyLngvc3ByaW5nLWNsb3VkLWFsaWJhYmEtZXhhbXBsZXMvbmFjb3MtZXhhbXBsZS9uYWNvcy1jb25maWctZXhhbXBsZQ==">Nacos 配置管理示例</a></p>
</li>
</ol>
<h2 id="接入-Nacos-服务注册与发现"><a href="#接入-Nacos-服务注册与发现" class="headerlink" title="接入 Nacos 服务注册与发现"></a>接入 Nacos 服务注册与发现</h2><h3 id="接入-Nacos-Discovery"><a href="#接入-Nacos-Discovery" class="headerlink" title="接入 Nacos Discovery"></a>接入 Nacos Discovery</h3><p>如果要在你的项目中使用 Nacos 来作为服务发现的组件。需要进行以下操作（确保 Nacos Server 已启动）：</p>
<ol>
<li><p>需要在 pom.xml 文件中引入 group ID 为 com.alibaba.cloud 和 artifact ID 为 spring-cloud-stater-alibaba-nacos-discovery 的 stater：</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>添加应用配置：在应用的 /src/main/resources/application.properties 配置文件中配置 Nacos Server 地址：</p>
<figure class="highlight properties"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">spring.cloud.nacos.discovery.server-addr</span>=<span class="string">127.0.0.1:8848</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>使用 @EnableDiscoveryClient 注解开启服务注册与发现功能：</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProviderApplication</span> {</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> {</span><br><span class="line">        SpringApplication.run(ProviderApplication.class, args);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RestController</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">EchoController</span> {</span><br><span class="line">        <span class="meta">@GetMapping(value = "/echo/{string}")</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">echo</span><span class="params">(<span class="meta">@PathVariable</span> String string)</span> {</span><br><span class="line">            <span class="keyword">return</span> string;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
</ol>
<h3 id="启动应用并验证-1"><a href="#启动应用并验证-1" class="headerlink" title="启动应用并验证"></a>启动应用并验证</h3><p><strong>应用启动</strong></p>
<ol>
<li><p>添加配置：在 <a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2FsaWJhYmEvc3ByaW5nLWNsb3VkLWFsaWJhYmEvdHJlZS8yMDIyLngvc3ByaW5nLWNsb3VkLWFsaWJhYmEtZXhhbXBsZXMvbmFjb3MtZXhhbXBsZS9uYWNvcy1kaXNjb3ZlcnktZXhhbXBsZS9uYWNvcy1kaXNjb3ZlcnktcHJvdmlkZXItZXhhbXBsZQ==">nacos-discovery-provider-example</a> 项目的 /src/main/resources/application.properties 中添加基本配置信息:</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">spring.application.name=service-provider</span><br><span class="line"></span><br><span class="line">server.port=18082</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>启动应用，支持 IDE 直接启动和编译打包后启动。</p>
<ul>
<li>IDE 直接启动：找到 <a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2FsaWJhYmEvc3ByaW5nLWNsb3VkLWFsaWJhYmEvdHJlZS8yMDIyLngvc3ByaW5nLWNsb3VkLWFsaWJhYmEtZXhhbXBsZXMvbmFjb3MtZXhhbXBsZS9uYWNvcy1kaXNjb3ZlcnktZXhhbXBsZS9uYWNvcy1kaXNjb3ZlcnktcHJvdmlkZXItZXhhbXBsZQ==">nacos-discovery-provider-example</a> 项目的主类 ProviderApplication，执行 main 方法启动应用。</li>
<li>打包编译后启动：在 <a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2FsaWJhYmEvc3ByaW5nLWNsb3VkLWFsaWJhYmEvdHJlZS8yMDIyLngvc3ByaW5nLWNsb3VkLWFsaWJhYmEtZXhhbXBsZXMvbmFjb3MtZXhhbXBsZS9uYWNvcy1kaXNjb3ZlcnktZXhhbXBsZS9uYWNvcy1kaXNjb3ZlcnktcHJvdmlkZXItZXhhbXBsZQ==">nacos-discovery-provider-example</a> 项目中执行 mvn clean package 将工程编译打包，然后执行 java - jar nacos-discovery-provider-example.jar 启动应用。</li>
</ul>
</li>
</ol>
<p><strong>验证</strong></p>
<ol>
<li><p>查询服务</p>
<p>使用 Shell 终端输入如下命令查询，可以看到服务节点已经成功注册到 Nacos Server。</p>
<p>Terminal window</p>
<figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line">$ curl http://127.0.0.1:8848/nacos/v1/ns/catalog/instances?serviceName=service-provider&amp;clusterName=DEFAULT&amp;pageSize=10&amp;pageNo=1&amp;namespaceId=</span><br></pre></td></tr></tbody></table></figure>
<p>响应结果：</p>
<figure class="highlight json"><table><tbody><tr><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">"list"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"ip"</span><span class="punctuation">:</span> <span class="string">"192.168.3.19"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"port"</span><span class="punctuation">:</span> <span class="number">1000</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"weight"</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"healthy"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"enabled"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"ephemeral"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"clusterName"</span><span class="punctuation">:</span> <span class="string">"DEFAULT"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"serviceName"</span><span class="punctuation">:</span> <span class="string">"DEFAULT_GROUP@@service-provider"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"metadata"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line"></span><br><span class="line">        <span class="attr">"preserved.register.source"</span><span class="punctuation">:</span> <span class="string">"SPRING_CLOUD"</span></span><br><span class="line"></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"instanceHeartBeatInterval"</span><span class="punctuation">:</span> <span class="number">5000</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"instanceHeartBeatTimeOut"</span><span class="punctuation">:</span> <span class="number">15000</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"ipDeleteTimeout"</span><span class="punctuation">:</span> <span class="number">30000</span></span><br><span class="line"></span><br><span class="line">    <span class="punctuation">}</span></span><br><span class="line"></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">"count"</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>服务发现</p>
<p>在 pom.xml 中加入以下依赖：</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-loadbalancer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>在配置文件中加入以下配置：</p>
<figure class="highlight properties"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">spring.cloud.loadbalancer.ribbon.enabled</span>=<span class="string">false</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring.cloud.loadbalancer.nacos.enabled</span>=<span class="string">true</span></span><br></pre></td></tr></tbody></table></figure>
</li>
</ol>
<h3 id="服务消费"><a href="#服务消费" class="headerlink" title="服务消费"></a>服务消费</h3><h4 id="应用配置"><a href="#应用配置" class="headerlink" title="应用配置"></a>应用配置</h4><p>本章节只是为了便于您理解接入方式，此处只涉及 Ribbon、RestTemplate、FeignClient 相关内容，如果已经使用了其他服务发现组件，可以通过直接替换依赖来接入 spring-cloud-starter-alibaba-nacos-config。</p>
<ol>
<li><p>添加 @LoadBlanced 注解，使得 RestTemplate 接入 Ribbon：</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@LoadBalanced</span></span><br><span class="line"><span class="keyword">public</span> RestTemplate <span class="title function_">restTemplate</span><span class="params">()</span> {</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>FeignClient 已经默认集成了 Ribbon ，此处演示如何配置一个 FeignClient：</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@FeignClient(name = "service-provider")</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">EchoService</span> {</span><br><span class="line">    <span class="meta">@GetMapping(value = "/echo/{str}")</span></span><br><span class="line">    String <span class="title function_">echo</span><span class="params">(<span class="meta">@PathVariable("str")</span> String str)</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>使用 @FeignClient 注解将 EchoService 这个接口包装成一个 FeignClient，属性 name 对应服务名 service-provider。</p>
<p>echo 方法上的 @GetMapping 注解将 echo 方法与 URL “/echo/{str}” 相对应，@PathVariable 注解将 URL 路径中的 {str} 对应成 echo 方法的参数 str。</p>
</li>
<li><p>将两者注入到 Controller 中：</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestController</span> {</span><br><span class="line">    <span class="meta">@Autowired</span>    </span><br><span class="line">    <span class="keyword">private</span> RestTemplate restTemplate;    </span><br><span class="line">    <span class="meta">@Autowired</span>    </span><br><span class="line">    <span class="keyword">private</span> EchoService echoService;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping(value = "/echo-rest/{str}")</span>    </span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">rest</span><span class="params">(<span class="meta">@PathVariable</span> String str)</span> {        </span><br><span class="line">        <span class="keyword">return</span> restTemplate.getForObject(<span class="string">"http://service-provider/echo/"</span> + str, String.class);    </span><br><span class="line">    }    </span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping(value = "/echo-feign/{str}")</span>    </span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">feign</span><span class="params">(<span class="meta">@PathVariable</span> String str)</span> {        </span><br><span class="line">        <span class="keyword">return</span> echoService.echo(str);    </span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>添加必要的配置：</p>
<p>在 <a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2FsaWJhYmEvc3ByaW5nLWNsb3VkLWFsaWJhYmEvdHJlZS8yMDIyLngvc3ByaW5nLWNsb3VkLWFsaWJhYmEtZXhhbXBsZXMvbmFjb3MtZXhhbXBsZS9uYWNvcy1kaXNjb3ZlcnktZXhhbXBsZS9uYWNvcy1kaXNjb3ZlcnktY29uc3VtZXItZXhhbXBsZQ==">nacos-discovery-consumer-example</a> 项目的 /src/main/resources/application.properties 中添加基本配置信息：</p>
<figure class="highlight properties"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">spring.application.name</span>=<span class="string">service-consumer</span></span><br><span class="line"></span><br><span class="line"><span class="attr">server.port</span>=<span class="string">18083</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>启动应用</p>
<ul>
<li>IDE 直接启动：找到 <a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2FsaWJhYmEvc3ByaW5nLWNsb3VkLWFsaWJhYmEvdHJlZS8yMDIyLngvc3ByaW5nLWNsb3VkLWFsaWJhYmEtZXhhbXBsZXMvbmFjb3MtZXhhbXBsZS9uYWNvcy1kaXNjb3ZlcnktZXhhbXBsZS9uYWNvcy1kaXNjb3ZlcnktY29uc3VtZXItZXhhbXBsZQ==">nacos-discovery-consumer-example</a> 项目的主类 ConsumerApplication，执行 main 方法启动应用。</li>
<li>打包编译后启动：在 <a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2FsaWJhYmEvc3ByaW5nLWNsb3VkLWFsaWJhYmEvdHJlZS8yMDIyLngvc3ByaW5nLWNsb3VkLWFsaWJhYmEtZXhhbXBsZXMvbmFjb3MtZXhhbXBsZS9uYWNvcy1kaXNjb3ZlcnktZXhhbXBsZS9uYWNvcy1kaXNjb3ZlcnktY29uc3VtZXItZXhhbXBsZQ==">nacos-discovery-consumer-example</a> 项目中执行 mvn clean package 将工程编译打包，然后执行 java -jar nacos-discovery-consumer-example.jar 启动应用。</li>
</ul>
</li>
</ol>
<h4 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h4><ol>
<li><p>请求 <a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cDovLzEyNy4wLjAuMToxODA4My9lY2hvLXJlc3QvMTIzNA==">http://127.0.0.1:18083/echo-rest/1234</a> 地址，可以看到响应显示了 nacos-discovery-provider-example 返回的消息 “hello Nacos Discovery 1234”，证明服务发现生效。</p>
<p>Terminal window</p>
<figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line">$ curl http://127.0.0.1:18083/echo-rest/1234</span><br></pre></td></tr></tbody></table></figure>
<p>响应结果：</p>
<figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line">hello Nacos Discovery 1234</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>请求 <a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cDovLzEyNy4wLjAuMToxODA4My9lY2hvLWZlaWduLzEyMzQ1">http://127.0.0.1:18083/echo-feign/12345</a> 地址，可以看到响应显示了 nacos-discovery-provider-example 返回的消息 “hello Nacos Discovery 12345”，证明服务发现生效。</p>
<p>Terminal window</p>
<figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line">$ curl http://127.0.0.1:18083/echo-feign/12345</span><br></pre></td></tr></tbody></table></figure>
<p>响应结果：</p>
<figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line">hello Nacos Discovery 12345</span><br></pre></td></tr></tbody></table></figure>
</li>
</ol>
<p>Nacos 服务注册与发现示例源码参考：<a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2FsaWJhYmEvc3ByaW5nLWNsb3VkLWFsaWJhYmEvdHJlZS8yMDIyLngvc3ByaW5nLWNsb3VkLWFsaWJhYmEtZXhhbXBsZXMvbmFjb3MtZXhhbXBsZS9uYWNvcy1kaXNjb3ZlcnktZXhhbXBsZQ==">Nacos 服务注册与发现示例</a></p>
<hr>
<h1 id="进阶指南"><a href="#进阶指南" class="headerlink" title="进阶指南"></a>进阶指南</h1><p>本章节展示 spring-cloud-starter-alibaba-nacos-config 和 spring-cloud-starter-nacos-discovery 的高级特性和进阶用法。</p>
<h2 id="Nacos-配置中心进阶指南"><a href="#Nacos-配置中心进阶指南" class="headerlink" title="Nacos 配置中心进阶指南"></a>Nacos 配置中心进阶指南</h2><h3 id="profile-粒度配置"><a href="#profile-粒度配置" class="headerlink" title="profile 粒度配置"></a>profile 粒度配置</h3><p>spring-cloud-starter-alibaba-nacos-congig 在加载服务配置时：</p>
<p>不仅仅加载了以  dataId 为 ${spring.application.name}.${file-extension:properties} 为前缀的基础配置，还加载了 dataId 为 ${spring.application.name}-${profile}.${file-extension:properties } 的基础配置。</p>
<p>在日常开发中如果遇到多套环境下的不同配置，可以通过 Spring 提供的 ${spring.profiles.active} 这个配置项选择不同情况下的配置。</p>
<figure class="highlight properties"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">spring.profiles.active</span>=<span class="string">develop</span></span><br></pre></td></tr></tbody></table></figure>
<p>Nacos 上新增一个 dataId 为：nacos-config-develop.yaml 的基础配置，如下所示：</p>
<figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">Data ID:</span> <span class="string">nacos-config-develop.yaml</span></span><br><span class="line"><span class="attr">Group:</span> <span class="string">DEFAULT_GROUP</span></span><br><span class="line"><span class="string">配置格式:</span> <span class="string">YAML</span></span><br><span class="line"><span class="string">配置内容:</span> <span class="attr">current.env:</span> <span class="string">develop-env</span></span><br></pre></td></tr></tbody></table></figure>
<p>启动 Spring Boot 应用测试的代码如下：</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProviderApplication</span> {</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> {</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> SpringApplication.run(ProviderApplication.class, args);</span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">true</span>) {</span><br><span class="line">            <span class="type">String</span> <span class="variable">userName</span> <span class="operator">=</span> applicationContext.getEnvironment().getProperty(<span class="string">"user.name"</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">userAge</span> <span class="operator">=</span> applicationContext.getEnvironment().getProperty(<span class="string">"user.age"</span>);</span><br><span class="line">            <span class="comment">//获取当前部署的环境</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">currentEnv</span> <span class="operator">=</span> applicationContext.getEnvironment().getProperty(<span class="string">"current.env"</span>);</span><br><span class="line">            System.err.println(<span class="string">"in "</span>+currentEnv+<span class="string">" enviroment; "</span>+<span class="string">"user name :"</span> + userName + <span class="string">"; age: "</span> + userAge);</span><br><span class="line">            TimeUnit.SECONDS.sleep(<span class="number">1</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>控制台输出结果如下：</p>
<figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">in</span> develop-env enviroment; user name :nacos-config-yaml-update; age: 68</span><br><span class="line"></span><br><span class="line">2018-11-02 15:34:25.013 INFO 33014 --- [ Thread-11] ConfigServletWebServerApplicationContext : Closing org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@6f1c29b7: startup <span class="built_in">date</span> [Fri Nov 02 15:33:57 CST 2018]; parent: org.springframework.context.annotation.AnnotationConfigApplicationContext@63355449</span><br></pre></td></tr></tbody></table></figure>
<p>如果需要切换到生产环境，只需要更改 ${spring.profiles.active} 参数配置即可。如下所示：</p>
<figure class="highlight properties"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">spring.profiles.active</span>=<span class="string">product</span></span><br></pre></td></tr></tbody></table></figure>
<p>同时生产环境上 Nacos 需要添加对应 dataId 的基础配置。例如，在生成环境下的 Nacos 添加了 dataId 为：nacos-config-product.yaml 的配置：</p>
<figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">Data ID:</span> <span class="string">nacos-config-product.yaml</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Group:</span> <span class="string">DEFAULT_GROUP</span></span><br><span class="line"></span><br><span class="line"><span class="string">配置格式:</span> <span class="string">YAML</span></span><br><span class="line"></span><br><span class="line"><span class="string">配置内容:</span> <span class="attr">current.env:</span> <span class="string">product-env</span></span><br></pre></td></tr></tbody></table></figure>
<p>启动测试程序，输出结果如下：</p>
<figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">in</span> product-env enviroment; user name :nacos-config-yaml-update; age: 68</span><br><span class="line"></span><br><span class="line">2018-11-02 15:42:14.628 INFO 33024 --- [Thread-11] ConfigServletWebServerApplicationContext : Closing org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@6aa8e115: startup <span class="built_in">date</span> [Fri Nov 02 15:42:03 CST 2018]; parent: org.springframework.context.annotation.AnnotationConfigApplicationContext@19bb07ed</span><br></pre></td></tr></tbody></table></figure>
<blockquote>
<p>Note：</p>
<p>此案例中我们通过 <code>spring.profiles.active=&lt;profilename&gt;</code> 的方式写死在配置文件中，而在真正的项目实施过程中这个变量的值是需要不同环境而有不同的值。这个时候通常的做法是通过 <code>-Dspring.profiles.active=&lt;profile&gt;</code> 参数指定其配置来达到环境间灵活的切换。</p>
</blockquote>
<h3 id="自定义-Namespace-的配置"><a href="#自定义-Namespace-的配置" class="headerlink" title="自定义 Namespace 的配置"></a>自定义 Namespace 的配置</h3><p>Nacos 内部有 <a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9uYWNvcy5pby96aC1jbi9kb2NzL2NvbmNlcHRzLmh0bWw=">Namespace</a> 的概念:</p>
<blockquote>
<p>用于进行租户粒度的配置隔离。不同的命名空间下，可以存在相同的 Group 或 Data ID 的配置。Namespace 的常用场景之一是不同环境的配置的区分隔离， 例如开发测试环境和生产环境的资源（如配置、服务）隔离等。 在没有明确指定 ${spring.cloud.nacos.config.namespace} 配置的情况下， 默认使用的是 Nacos 中 public 命名空间即默认的命名空间。如果需要使用自定义的命名空间，可以通过以下配置来实现：</p>
</blockquote>
<figure class="highlight properties"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">spring.cloud.nacos.config.namespace</span>=<span class="string">YOUR_NAMESPACE_ID</span></span><br></pre></td></tr></tbody></table></figure>
<blockquote>
<p>NOTE:</p>
<p><strong>该配置必须放在 bootstrap.properties 文件中</strong>。此外 spring.cloud.nacos.config.namespace 的值是 namespace 对应的 id，id 值可以在 Nacos 的控制台获取。并且在添加配置时注意不要选择其他的 namespace，否则将会导致读取不到正确的配置。</p>
</blockquote>
<h3 id="自定义-Group-的配置"><a href="#自定义-Group-的配置" class="headerlink" title="自定义 Group 的配置"></a>自定义 Group 的配置</h3><p>在没有明确指定 ${spring.cloud.nacos.config.group} 配置的情况下， 默认使用的是组 DEFAULT_GROUP 。如果需要自定义 Group，可以通过以下配置来实现：</p>
<figure class="highlight properties"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">spring.cloud.nacos.config.group</span>=<span class="string">YOUR_GROUP_NAME</span></span><br></pre></td></tr></tbody></table></figure>
<blockquote>
<p>NOTE:</p>
<p><strong>该配置必须放在 bootstrap.properties 文件中。</strong>并且在添加配置时 Group 的值一定要和 spring.cloud.nacos.config.group 的配置值一致。</p>
</blockquote>
<h3 id="配置的优先级"><a href="#配置的优先级" class="headerlink" title="配置的优先级"></a>配置的优先级</h3><p>Nacos Config 目前提供了三种配置能力从 Nacos 拉取相关的配置：</p>
<ul>
<li>A: 通过 spring.cloud.nacos.config.shared-dataids 支持多个共享 Data Id 的配置</li>
<li>B: 通过 spring.cloud.nacos.config.ext-config[n].data-id 的方式支持多个扩展 Data Id 的配置</li>
<li>C: 通过内部相关规则(应用名、应用名+ Profile )自动生成相关的 Data Id 配置</li>
</ul>
<p>当三种方式共同使用时，他们的一个优先级关系是: <strong><em>A &lt; B &lt; C\</em></strong></p>
<h3 id="springc-config-import-引入"><a href="#springc-config-import-引入" class="headerlink" title="springc.config.import 引入"></a>springc.config.import 引入</h3><p>这里假设有一个配置文件 bootstrap.yml，升级到 2021.0.1.0 以上的版本应该怎么配置呢？</p>
<p>bootstrap.yml</p>
<figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">test.yml</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">DEFAULT_GROUP</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:8848</span></span><br><span class="line">        <span class="attr">extension-configs:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">dataId:</span> <span class="string">test01.yml</span></span><br><span class="line">            <span class="attr">group:</span> <span class="string">group_01</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">dataId:</span> <span class="string">test02.yml</span></span><br><span class="line">            <span class="attr">group:</span> <span class="string">group_02</span></span><br><span class="line">            <span class="attr">refresh:</span> <span class="literal">false</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>注意：上面的配置和下面的配置是等价的！</strong></p>
<p>application.yml</p>
<figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">DEFAULT_GROUP</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:8848</span></span><br><span class="line">  <span class="attr">config:</span></span><br><span class="line">    <span class="attr">import:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">optional:nacos:test.yml</span> <span class="comment"># 监听 DEFAULT_GROUP:test.yml</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">optional:nacos:test01.yml?group=group_01</span> <span class="comment"># 覆盖默认 group，监听 group_01:test01.yml</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">optional:nacos:test02.yml?group=group_02&amp;refreshEnabled=false</span> <span class="comment"># 不开启动态刷新</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">nacos:test03.yml</span> <span class="comment"># 在拉取nacos配置异常时会快速失败，会导致 spring 容器启动失败</span></span><br></pre></td></tr></tbody></table></figure>
<p>使用 spring.config.import 引入配置时的注意事项如下：</p>
<ol>
<li>如果使用 spring.config.import 就不能使用 bootstrap.yml/properties 引入配置的方式了；</li>
<li>如果引入了 spring-cloud-starter-alibaba-nacos-config，并且使用 import 方式导入配置, 项目启动时会自动检测是否引入了 nacos 条目，如果没有 import nacos 条目，会出现如下错误：</li>
</ol>
<figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line">The spring.config.import property is missing a nacos: entry</span><br><span class="line">Action:</span><br><span class="line">Add a spring.config.import=nacos: property to your configuration.If configuration is not required add spring.config.import=optional:nacos: instead.To <span class="built_in">disable</span> this check, <span class="built_in">set</span> spring.cloud.nacos.config.import-check.enabled=<span class="literal">false</span>.</span><br></pre></td></tr></tbody></table></figure>
<p>可以通过手动设置 spring.cloud.nacos.config.import-check.enabled=false 关闭它，但是不建议这么做，这个功能可以帮助你检查是否引入多余依赖</p>
<p>假如想保留以前的使用方式 ( bootstrap 引入配置)，你只需要添加依赖 spring-cloud-starter-bootstrap 依赖，不需要修改一行代码即可完成配置方式的切换！</p>
<h3 id="配置项参考"><a href="#配置项参考" class="headerlink" title="配置项参考"></a>配置项参考</h3><p>更多关于 spring-cloud-starter-alibaba-nacos-config 的 starter 配置项如下所示:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>配置项</th>
<th>key</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>服务端地址</td>
<td>spring.cloud.nacos.config.server-addr</td>
<td></td>
<td>服务器 ip 和端口</td>
</tr>
<tr>
<td>DataId 前缀</td>
<td>spring.cloud.nacos.config.prefix</td>
<td>${spring.application.name}</td>
<td>DataId 的前缀，默认值为应用名称</td>
</tr>
<tr>
<td>Group</td>
<td>spring.cloud.nacos.config.group</td>
<td>DEFAULT_GROUP</td>
<td></td>
</tr>
<tr>
<td>DataId 后缀及内容文件格式</td>
<td>spring.cloud.nacos.config.file-extension</td>
<td>properties</td>
<td>DataId 的后缀，同时也是配置内容的文件格式，目前只支持 properties</td>
</tr>
<tr>
<td>配置内容的编码方式</td>
<td>spring.cloud.nacos.config.encode</td>
<td>UTF-8</td>
<td>配置的编码</td>
</tr>
<tr>
<td>获取配置的超时时间</td>
<td>spring.cloud.nacos.config.timeout</td>
<td>3000</td>
<td>单位为 ms</td>
</tr>
<tr>
<td>配置的命名空间</td>
<td>spring.cloud.nacos.config.namespace</td>
<td></td>
<td>常用场景之一是不同环境的配置的区分隔离，例如开发测试环境和生产环境的资源隔离等。</td>
</tr>
<tr>
<td>AccessKey</td>
<td>spring.cloud.nacos.config.access-key</td>
<td></td>
<td></td>
</tr>
<tr>
<td>SecretKey</td>
<td>spring.cloud.nacos.config.secret-key</td>
<td></td>
<td></td>
</tr>
<tr>
<td>相对路径</td>
<td>spring.cloud.nacos.config.context-path</td>
<td></td>
<td>服务端 API 的相对路径</td>
</tr>
<tr>
<td>接入点</td>
<td>spring.cloud.nacos.config.endpoint</td>
<td></td>
<td>地域的某个服务的入口域名，通过此域名可以动态地拿到服务端地址</td>
</tr>
<tr>
<td>是否开启监听和自动刷新</td>
<td>spring.cloud.nacos.config.refresh-enabled</td>
<td>true</td>
<td></td>
</tr>
<tr>
<td>集群服务名</td>
<td>spring.cloud.nacos.config.cluster-name</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Endpoint-信息"><a href="#Endpoint-信息" class="headerlink" title="Endpoint 信息"></a>Endpoint 信息</h3><p>请求 <a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cDovLzEyNy4wLjAuMToxODA4My9hY3R1YXRvci9uYWNvc2NvbmZpZw==">http://127.0.0.1:18083/actuator/nacosconfig</a> 地址，可以看到相关的 EndPoint 节点信息。</p>
<p>Terminal window</p>
<figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line">$ curl http://127.0.0.1:18083/actuator/nacosconfig</span><br></pre></td></tr></tbody></table></figure>
<p>响应结果：</p>
<figure class="highlight json"><table><tbody><tr><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">"NacosConfigProperties"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"serverAddr"</span><span class="punctuation">:</span> <span class="string">"127.0.0.1:8848"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"username"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"password"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"encode"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"group"</span><span class="punctuation">:</span> <span class="string">"DEFAULT_GROUP"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"prefix"</span><span class="punctuation">:</span> <span class="string">"PREFIX"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"fileExtension"</span><span class="punctuation">:</span> <span class="string">"properties"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"timeout"</span><span class="punctuation">:</span> <span class="number">3000</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"maxRetry"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"configLongPollTimeout"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"configRetryTime"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"enableRemoteSyncConfig"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"endpoint"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"namespace"</span><span class="punctuation">:</span> <span class="string">"NAMESPACE"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"accessKey"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"secretKey"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"ramRoleName"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"contextPath"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"clusterName"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"name"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"sharedConfigs"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"extensionConfigs"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"refreshEnabled"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"configServiceProperties"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"encode"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"secretKey"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"serveraddr"</span><span class="punctuation">:</span> <span class="string">"127.0.0.1:8848"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"prefix"</span><span class="punctuation">:</span> <span class="string">"PREFIX"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"configLongPollTimeout"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"maxRetry"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"password"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"configRetryTime"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"endpoint"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"serverAddr"</span><span class="punctuation">:</span> <span class="string">"127.0.0.1:8848"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"accessKey"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"enableRemoteSyncConfig"</span><span class="punctuation">:</span> <span class="string">"false"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"clusterName"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"namespace"</span><span class="punctuation">:</span> <span class="string">"NAMESPACE"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"ramRoleName"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"username"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"group"</span><span class="punctuation">:</span> <span class="string">"DEFAULT_GROUP"</span></span><br><span class="line"></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"refreshableDataids"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"extConfig"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"sharedDataids"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line"></span><br><span class="line">  <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">"RefreshHistory"</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">"Sources"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"lastSynced"</span><span class="punctuation">:</span> <span class="string">"2023-05-10 09:35:50"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"dataId"</span><span class="punctuation">:</span> <span class="string">"nacos-config-example.properties"</span></span><br><span class="line"></span><br><span class="line">    <span class="punctuation">}</span></span><br><span class="line"></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure>
<h2 id="Nacos-服务注册与发现进阶指南"><a href="#Nacos-服务注册与发现进阶指南" class="headerlink" title="Nacos 服务注册与发现进阶指南"></a>Nacos 服务注册与发现进阶指南</h2><h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>spring-cloud-starter-alibaba-nacos-discovery 遵循了 Spring Cloud Common 标准，实现了 AutoServiceRegistration、ServiceRegistry、Registration 这三个接口。</p>
<p>在 Spring Cloud 应用的启动阶段，监听了 WebServerInitializedEvent 事件，当 Web 容器初始化完成后，即收到 WebServerInitializedEvent 事件后，会触发注册的动作，调用 ServiceRegistry 的 register 方法，将服务注册到 Nacos Server。</p>
<h3 id="IPv4-至-IPv6-地址迁移方案"><a href="#IPv4-至-IPv6-地址迁移方案" class="headerlink" title="IPv4 至 IPv6 地址迁移方案"></a>IPv4 至 IPv6 地址迁移方案</h3><p><strong>IPv4 和 IPv6 地址双注册</strong></p>
<p>在配置完成 Spring Cloud Loadbalancer 作为负载均衡策略后，应用启动后会默认将微服务的 IPv4 地址和 IPv6 地址注册到注册中心中，其中 IPv4 地址会存放在 Nacos 服务列表中的 IP 字段下， IPv6 地址在 Nacos 的 metadata 字段中，其对应的 Key 为 IPv6 。当服务消费者调用服务提供者时，会根据自身的 IP 地址栈支持情况，选择合适的 IP 地址类型发起服务调用。</p>
<p>具体规则：</p>
<ol>
<li>服务消费者本身支持 IPv4 和 IPv6 双地址栈或仅支持 IPv6 地址栈的情况下，服务消费者会使用服务提供的 IPv6 地址发起服务调用，IPv6 地址调用失败且服务本身同时支持 IPv4 地址栈时，暂不支持切换到 IPv4 地址发起重试调用；</li>
<li>服务消费者本身仅支持 IPv4 单地址栈的情况下，服务消费者会使用服务提供的 IPv4 地址发起服务调用。</li>
</ol>
<p><strong>仅注册 IPv4</strong></p>
<p>如果您只想使用 IPv4 地址进行注册，可以在 application.properties 使用如下配置项进行配置：</p>
<figure class="highlight properties"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">spring.cloud.nacos.discovery.ip-type</span>=<span class="string">IPv4</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>仅注册 IPv6</strong></p>
<p>如果您只想使用 IPv6 地址，可以在 application.properties 使用如下配置项进行配置：</p>
<figure class="highlight properties"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">spring.cloud.nacos.discovery.ip-type</span>=<span class="string">IPv6</span></span><br></pre></td></tr></tbody></table></figure>
<h3 id="配置项参考-1"><a href="#配置项参考-1" class="headerlink" title="配置项参考"></a>配置项参考</h3><p>更多关于 spring-cloud-starter-alibaba-nacos-discovery 的 starter 配置项如下所示:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>配置项</th>
<th>key</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>服务端地址</td>
<td>spring.cloud.nacos.discovery.server-addr</td>
<td></td>
<td></td>
</tr>
<tr>
<td>服务名</td>
<td>spring.cloud.nacos.discovery.service</td>
<td>应用名</td>
<td>注册到 Nacos 上的服务名称，默认值为应用名称</td>
</tr>
<tr>
<td>权重</td>
<td>spring.cloud.nacos.discovery.weight</td>
<td>1</td>
<td>取值范围 1 到 100，数值越大，权重越大</td>
</tr>
<tr>
<td>网卡名</td>
<td>spring.cloud.nacos.discovery.network-interface</td>
<td></td>
<td>当 IP 未配置时，注册的 IP 为此网卡所对应的 IP 地址，如果此项也未配置，则默认取第一块网卡的地址</td>
</tr>
<tr>
<td>注册的 IP 地址</td>
<td>spring.cloud.nacos.discovery.ip</td>
<td></td>
<td>优先级最高</td>
</tr>
<tr>
<td>注册的 IP 地址类型</td>
<td>spring.cloud.nacos.discovery.ip-type</td>
<td>双栈地址</td>
<td>可以配置 IPv4 和 IPv6 两种类型，如果网卡同类型 IP 地址存在多个，希望制定特定网段地址，可使用<code>spring.cloud.inetutils.preferred-networks</code>配置筛选地址</td>
</tr>
<tr>
<td>注册的端口</td>
<td>spring.cloud.nacos.discovery.port</td>
<td>-1</td>
<td>默认情况下不用配置，会自动探测</td>
</tr>
<tr>
<td>命名空间</td>
<td>spring.cloud.nacos.discovery.namespace</td>
<td></td>
<td>常用场景之一是不同环境的注册的区分隔离，例如开发测试环境和生产环境的资源（如配置、服务）隔离等。</td>
</tr>
<tr>
<td>AccessKey</td>
<td>spring.cloud.nacos.discovery.access-key</td>
<td></td>
<td></td>
</tr>
<tr>
<td>SecretKey</td>
<td>spring.cloud.nacos.discovery.secret-key</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Metadata</td>
<td>spring.cloud.nacos.discovery.metadata</td>
<td></td>
<td>使用 Map 格式配置</td>
</tr>
<tr>
<td>日志文件名</td>
<td>spring.cloud.nacos.discovery.log-name</td>
<td></td>
<td></td>
</tr>
<tr>
<td>集群</td>
<td>spring.cloud.nacos.discovery.cluster-name</td>
<td>DEFAULT</td>
<td>Nacos 集群名称</td>
</tr>
<tr>
<td>接入点</td>
<td>spring.cloud.nacos.discovery.endpoint</td>
<td></td>
<td>地域的某个服务的入口域名，通过此域名可以动态地拿到服务端地址</td>
</tr>
<tr>
<td>是否集成 LoadBalancer</td>
<td>spring.cloud.loadbalancer.nacos.enabled</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>是否开启 Nacos Watch</td>
<td>spring.cloud.nacos.discovery.watch.enabled</td>
<td>false</td>
<td>可以设置成 true 来开启 watch</td>
</tr>
<tr>
<td>是否启用 Nacos</td>
<td>spring.cloud.nacos.discovery.register-enabled</td>
<td>true</td>
<td>默认启动，设置为 false 时会关闭自动向 Nacos 注册的功能</td>
</tr>
<tr>
<td>是否启用容错配置</td>
<td><code>spring.cloud.nacos.discovery.failure-tolerance-enabled</code></td>
<td>false</td>
<td>开启 nacos 服务发现失败容错能力，该功能会在 nacos 获取实例失败时返回上一次获取的实例，可以在 nacos server 网络不稳定时提供容错能力，不会导致请求全部挂掉</td>
</tr>
</tbody>
</table>
</div>
<h3 id="Endpoint-信息-1"><a href="#Endpoint-信息-1" class="headerlink" title="Endpoint 信息"></a>Endpoint 信息</h3><p>请求 <a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cDovLzEyNy4wLjAuMToxODA4My9hY3R1YXRvci9uYWNvc2Rpc2NvdmVyeQ==">http://127.0.0.1:18083/actuator/nacosdiscovery</a> 地址，可以看到相关的 EndPoint 节点信息。</p>
<p>Terminal window</p>
<figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line">$ curl http://127.0.0.1:18083/actuator/nacosdiscovery</span><br></pre></td></tr></tbody></table></figure>
<p>响应结果：</p>
<figure class="highlight json"><table><tbody><tr><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">"subscribe"</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">"NacosDiscoveryProperties"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"serverAddr"</span><span class="punctuation">:</span> <span class="string">"127.0.0.1:8848"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"username"</span><span class="punctuation">:</span> <span class="string">"nacos"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"password"</span><span class="punctuation">:</span> <span class="string">"nacos"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"endpoint"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"namespace"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"watchDelay"</span><span class="punctuation">:</span> <span class="number">30000</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"logName"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"service"</span><span class="punctuation">:</span> <span class="string">"service-consumer"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"weight"</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"clusterName"</span><span class="punctuation">:</span> <span class="string">"DEFAULT"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"group"</span><span class="punctuation">:</span> <span class="string">"DEFAULT_GROUP"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"namingLoadCacheAtStart"</span><span class="punctuation">:</span> <span class="string">"false"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"metadata"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"IPv6"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"preserved.register.source"</span><span class="punctuation">:</span> <span class="string">"SPRING_CLOUD"</span></span><br><span class="line"></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"registerEnabled"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"ip"</span><span class="punctuation">:</span> <span class="string">"192.168.3.19"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"networkInterface"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"ipType"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"port"</span><span class="punctuation">:</span> <span class="number">18083</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"secure"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"accessKey"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"secretKey"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"heartBeatInterval"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"heartBeatTimeout"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"ipDeleteTimeout"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"instanceEnabled"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"ephemeral"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"failureToleranceEnabled"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"failFast"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">"nacosProperties"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"password"</span><span class="punctuation">:</span> <span class="string">"nacos"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"endpoint"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"secretKey"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"serverAddr"</span><span class="punctuation">:</span> <span class="string">"127.0.0.1:8848"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"accessKey"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"clusterName"</span><span class="punctuation">:</span> <span class="string">"DEFAULT"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"namespace"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"com.alibaba.nacos.naming.log.filename"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"namingLoadCacheAtStart"</span><span class="punctuation">:</span> <span class="string">"false"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"failFast"</span><span class="punctuation">:</span> <span class="string">"true"</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">"username"</span><span class="punctuation">:</span> <span class="string">"nacos"</span></span><br><span class="line"></span><br><span class="line">    <span class="punctuation">}</span></span><br><span class="line"></span><br><span class="line">  <span class="punctuation">}</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src="/img/basic/avatar.png" title="头像" alt="头像"><img class="post-copyright__author_img_front" src="/img/basic/avatar.png" title="头像" alt="头像"></a><div class="post-copyright__author_name">violet</div><div class="post-copyright__author_desc">生活明朗，万物可爱</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/posts/95afb97c.html">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/posts/95afb97c.html')">Nacos 安装与使用</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://c-ssl.dtstatic.com/uploads/blog/202304/15/20230415081411_9a88c.thumb.400_0.jpg" target="_blank"><img class="post-qr-code-img" src="https://c-ssl.dtstatic.com/uploads/blog/202304/15/20230415081411_9a88c.thumb.400_0.jpg" alt="微信"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://tupian.qqw21.com/article/UploadPic/2020-6/20206416212275003.jpg" target="_blank"><img class="post-qr-code-img" src="https://tupian.qqw21.com/article/UploadPic/2020-6/20206416212275003.jpg" alt="支付宝"></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/posts/95afb97c.html"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=Nacos 安装与使用&amp;url=http://example.com/posts/95afb97c.html&amp;pic=https://cdn.apifox.cn/app/project-icon/custom/20221110/b67baa75-a01e-49c3-81fc-da1f2982343a.jpeg" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Violet博客屋</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/nacos/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>nacos<span class="tagsPageCount">1</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://img.zcool.cn/community/01c5355e5c78d3a8012165183b7ae8.jpg@2o.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/386349fe.html"><img class="prev-cover" src="https://picx.zhimg.com/v2-7ed54d37ea72cd82ab66a8fa3fc24c14_720w.jpg?source=172ae18b" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Git 安装与使用</div></div></a></div><div class="next-post pull-right"><a href="/posts/7f7493d0.html"><img class="next-cover" src="https://boosterminiclass.com/wp-content/uploads/2023/07/intellij_idea_git_2.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">IDEA 使用 Git 详解(一)</div></div></a></div></nav><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)" style="display: none">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div></div><div class="comment-wrap"><div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src="/img/basic/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"><div class="author-status"><img class="g-status" src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">产品、设计、开发</b>相关的问题和看法，还有<b style="color:#fff">文章翻译</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">violet</h1><div class="author-info__desc">生活明朗，万物可爱</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/Violetlx" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/372204786" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来看我的博客鸭~</div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://bu.dusays.com/2023/05/13/645fa415e8694.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">概述</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%B8%8E%E5%8F%91%E7%8E%B0"><span class="toc-number">1.1.</span> <span class="toc-text">服务注册与发现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86"><span class="toc-number">1.2.</span> <span class="toc-text">配置管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Nacos-%E6%A6%82%E8%BF%B0"><span class="toc-number">1.3.</span> <span class="toc-text">Nacos 概述</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B"><span class="toc-number">2.</span> <span class="toc-text">快速开始</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-Nacos-Server"><span class="toc-number">2.1.</span> <span class="toc-text">安装 Nacos Server</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A5%E5%85%A5%E4%BA%91%E4%B8%8A%E5%85%8D%E8%B4%B9%E7%89%88%E6%9C%AC"><span class="toc-number">2.1.1.</span> <span class="toc-text">接入云上免费版本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E5%AE%89%E8%A3%85%E6%96%B9%E5%BC%8F"><span class="toc-number">2.1.2.</span> <span class="toc-text">本地安装方式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A5%E5%85%A5-Nacos-%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83"><span class="toc-number">2.2.</span> <span class="toc-text">接入 Nacos 配置中心</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A5%E5%85%A5-Nacos-Config"><span class="toc-number">2.2.1.</span> <span class="toc-text">接入 Nacos Config</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0-Nacos-%E9%85%8D%E7%BD%AE"><span class="toc-number">2.2.2.</span> <span class="toc-text">添加 Nacos 配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E5%BA%94%E7%94%A8%E5%B9%B6%E9%AA%8C%E8%AF%81"><span class="toc-number">2.2.3.</span> <span class="toc-text">启动应用并验证</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A5%E5%85%A5-Nacos-%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%B8%8E%E5%8F%91%E7%8E%B0"><span class="toc-number">2.3.</span> <span class="toc-text">接入 Nacos 服务注册与发现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A5%E5%85%A5-Nacos-Discovery"><span class="toc-number">2.3.1.</span> <span class="toc-text">接入 Nacos Discovery</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E5%BA%94%E7%94%A8%E5%B9%B6%E9%AA%8C%E8%AF%81-1"><span class="toc-number">2.3.2.</span> <span class="toc-text">启动应用并验证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E6%B6%88%E8%B4%B9"><span class="toc-number">2.3.3.</span> <span class="toc-text">服务消费</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E9%85%8D%E7%BD%AE"><span class="toc-number">2.3.3.1.</span> <span class="toc-text">应用配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81"><span class="toc-number">2.3.3.2.</span> <span class="toc-text">验证</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%9B%E9%98%B6%E6%8C%87%E5%8D%97"><span class="toc-number">3.</span> <span class="toc-text">进阶指南</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Nacos-%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E8%BF%9B%E9%98%B6%E6%8C%87%E5%8D%97"><span class="toc-number">3.1.</span> <span class="toc-text">Nacos 配置中心进阶指南</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#profile-%E7%B2%92%E5%BA%A6%E9%85%8D%E7%BD%AE"><span class="toc-number">3.1.1.</span> <span class="toc-text">profile 粒度配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89-Namespace-%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">3.1.2.</span> <span class="toc-text">自定义 Namespace 的配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89-Group-%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">3.1.3.</span> <span class="toc-text">自定义 Group 的配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E7%9A%84%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-number">3.1.4.</span> <span class="toc-text">配置的优先级</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#springc-config-import-%E5%BC%95%E5%85%A5"><span class="toc-number">3.1.5.</span> <span class="toc-text">springc.config.import 引入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E9%A1%B9%E5%8F%82%E8%80%83"><span class="toc-number">3.1.6.</span> <span class="toc-text">配置项参考</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Endpoint-%E4%BF%A1%E6%81%AF"><span class="toc-number">3.1.7.</span> <span class="toc-text">Endpoint 信息</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Nacos-%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%B8%8E%E5%8F%91%E7%8E%B0%E8%BF%9B%E9%98%B6%E6%8C%87%E5%8D%97"><span class="toc-number">3.2.</span> <span class="toc-text">Nacos 服务注册与发现进阶指南</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">3.2.1.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IPv4-%E8%87%B3-IPv6-%E5%9C%B0%E5%9D%80%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88"><span class="toc-number">3.2.2.</span> <span class="toc-text">IPv4 至 IPv6 地址迁移方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E9%A1%B9%E5%8F%82%E8%80%83-1"><span class="toc-number">3.2.3.</span> <span class="toc-text">配置项参考</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Endpoint-%E4%BF%A1%E6%81%AF-1"><span class="toc-number">3.2.4.</span> <span class="toc-text">Endpoint 信息</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/e22607b1.html" title="词"><img src="https://img.zcool.cn/community/01c5355e5c78d3a8012165183b7ae8.jpg@2o.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="词"></a><div class="content"><a class="title" href="/posts/e22607b1.html" title="词">词</a><time datetime="2024-10-08T08:22:02.000Z" title="发表于 2024-10-08 16:22:02">2024-10-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/1f44fecb.html" title="诗"><img src="https://img.zcool.cn/community/01b08e5e5c78d3a80121651842666c.jpg@2o.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="诗"></a><div class="content"><a class="title" href="/posts/1f44fecb.html" title="诗">诗</a><time datetime="2024-10-08T08:22:01.000Z" title="发表于 2024-10-08 16:22:01">2024-10-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/c5b41cb.html" title="SaToken鉴权框架-深入"><img src="https://picx.zhimg.com/v2-fa9bc3ed9d6f65d08873fc8cd2eec058_720w.jpg?source=172ae18b" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SaToken鉴权框架-深入"></a><div class="content"><a class="title" href="/posts/c5b41cb.html" title="SaToken鉴权框架-深入">SaToken鉴权框架-深入</a><time datetime="2024-10-08T08:03:25.000Z" title="发表于 2024-10-08 16:03:25">2024-10-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/fe850976.html" title="SaToken鉴权框架-基础"><img src="https://picx.zhimg.com/v2-fa9bc3ed9d6f65d08873fc8cd2eec058_720w.jpg?source=172ae18b" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SaToken鉴权框架-基础"></a><div class="content"><a class="title" href="/posts/fe850976.html" title="SaToken鉴权框架-基础">SaToken鉴权框架-基础</a><time datetime="2024-09-27T08:32:20.000Z" title="发表于 2024-09-27 16:32:20">2024-09-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/fe850976.html" title="SaToken鉴权框架"><img src="https://picx.zhimg.com/v2-fa9bc3ed9d6f65d08873fc8cd2eec058_720w.jpg?source=172ae18b" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SaToken鉴权框架"></a><div class="content"><a class="title" href="/posts/fe850976.html" title="SaToken鉴权框架">SaToken鉴权框架</a><time datetime="2024-09-27T08:32:20.000Z" title="发表于 2024-09-27 16:32:20">2024-09-27</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" target="_blank" rel="noopener" href="https://mail.qq.com/" title="email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://weibo.com/" title="微博"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a><a class="deal_link" href="/atom.xml" title="RSS"><i class="anzhiyufont anzhiyu-icon-rss"></i></a><img class="footer_mini_logo" title="返回顶部" alt="返回顶部" onclick="anzhiyu.scrollToDest(0, 500)" src="https://media.giphy.com/media/zymjdD521GHBu/giphy.gif" size="50px"><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://www.bilibili.com/" title="Bilibili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://www.douyin.com/" title="抖音"><i class="anzhiyufont anzhiyu-icon-tiktok"></i></a></div><div id="anzhiyu-footer"><div class="footer-group"><div class="footer-title">服务</div><div class="footer-links"><a class="footer-item" title="51la统计" target="_blank" rel="noopener" href="https://v6.51.la/">51la统计</a><a class="footer-item" title="十年之约" target="_blank" rel="noopener" href="https://www.foreverblog.cn/">十年之约</a><a class="footer-item" title="开往" target="_blank" rel="noopener" href="https://github.com/travellings-link/travellings">开往</a></div></div><div class="footer-group"><div class="footer-title">主题</div><div class="footer-links"><a class="footer-item" title="文档" href="/docs/">文档</a><a class="footer-item" title="源码" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu">源码</a><a class="footer-item" title="更新日志" href="/update/">更新日志</a></div></div><div class="footer-group"><div class="footer-title">导航</div><div class="footer-links"><a class="footer-item" title="即刻短文" href="/essay/">即刻短文</a><a class="footer-item" title="友链文章" href="/fcircle/">友链文章</a><a class="footer-item" title="留言板" href="/comments/">留言板</a></div></div><div class="footer-group"><div class="footer-title">协议</div><div class="footer-links"><a class="footer-item" title="隐私协议" href="/privacy/">隐私协议</a><a class="footer-item" title="Cookies" href="/cookies/">Cookies</a><a class="footer-item" title="版权协议" href="/copyright/">版权协议</a></div></div><div class="footer-group"><div class="footer-title-group"><div class="footer-title">友链</div><a class="random-friends-btn" id="footer-random-friends-btn" href="javascript:addFriendLinksInFooter();" title="换一批友情链接"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i></a></div><div class="footer-links" id="friend-links-in-footer"></div></div></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v5.4.0" title="博客框架为Hexo_v5.4.0"><img src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Frame-Hexo.svg" alt="博客框架为Hexo_v5.4.0"></a><a class="github-badge" target="_blank" href="https://blog.anheyu.com/" style="margin-inline:5px" data-title="本站使用AnZhiYu主题" title="本站使用AnZhiYu主题"><img src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.9/img/Theme-AnZhiYu-2E67D3.svg" alt="本站使用AnZhiYu主题"></a></p></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">©2024 By <a class="footer-bar-link" href="/" title="violet" target="_blank">violet</a></div></div><div id="footer-type-tips"></div><div class="js-pjax"><script>function subtitleType () {
  fetch('https://v1.hitokoto.cn')
    .then(response => response.json())
    .then(data => {
      if (true) {
        const from = '出自 ' + data.from
        const sub = []
        sub.unshift(data.hitokoto, from)
        window.typed = new Typed('#footer-type-tips', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('footer-type-tips').innerHTML = data.hitokoto
      }
    })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.cbd.int/typed.js@2.1.0/dist/typed.umd.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">22</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">12</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">7</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://violet.zeabur.app/" title="博客"><img class="back-menu-item-icon" src="/img/favicon.ico" alt="博客"><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/" title="Github"><img class="back-menu-item-icon" src="https://pic4.zhimg.com/v2-341e1d3b2845db15bceeff70d3fe228b_r.jpg" alt="Github"><span class="back-menu-item-text">Github</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 博文</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 生活</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/shuoshuo/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 分享</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/photos/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/music/?id=1994908354&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/movies/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 影视</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/games/"><i class="anzhiyufont anzhiyu-icon-rocket faa-tada" style="font-size: 0.9em;"></i><span> 游戏厅</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 我的装备</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/collects/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 足迹</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/treasures/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 藏宝阁</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文档</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-book faa-tada" style="font-size: 0.9em;"></i><span> 随机文章</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/document/"><i class="anzhiyufont anzhiyu-icon-book faa-tada" style="font-size: 0.9em;"></i><span> 文档页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/itbaima/"><i class="anzhiyufont anzhiyu-icon-book faa-tada" style="font-size: 0.9em;"></i><span> 柏码</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/runoob/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 菜鸟教程</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/itheima/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 黑马程序员</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/SpringCloudAlibaba/"><i class="anzhiyufont anzhiyu-icon-book faa-tada" style="font-size: 0.9em;"></i><span> 阿里微服务</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友人帐</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友链</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 网站导航</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/front/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 前端</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/back-end/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 后端</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/programmer/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 程序员</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/ai/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> AI</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/about/"><span> 关于笔者</span></a></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Docker/" style="font-size: 0.88rem; color: rgb(62, 142, 131);">Docker<sup>2</sup></a><a href="/tags/IDEA/" style="font-size: 0.88rem; color: rgb(127, 141, 11);">IDEA<sup>4</sup></a><a href="/tags/Java%E7%A8%8B%E5%BA%8F%E5%91%98/" style="font-size: 0.88rem; color: rgb(185, 2, 112);">Java程序员<sup>3</sup></a><a href="/tags/MybatisPlus/" style="font-size: 0.88rem; color: rgb(37, 140, 99);">MybatisPlus<sup>1</sup></a><a href="/tags/SQL/" style="font-size: 0.88rem; color: rgb(15, 141, 37);">SQL<sup>1</sup></a><a href="/tags/SaToken/" style="font-size: 0.88rem; color: rgb(171, 106, 119);">SaToken<sup>3</sup></a><a href="/tags/VMware/" style="font-size: 0.88rem; color: rgb(12, 132, 156);">VMware<sup>1</sup></a><a href="/tags/VsCode/" style="font-size: 0.88rem; color: rgb(71, 4, 45);">VsCode<sup>1</sup></a><a href="/tags/git/" style="font-size: 0.88rem; color: rgb(136, 31, 103);">git<sup>1</sup></a><a href="/tags/nacos/" style="font-size: 0.88rem; color: rgb(44, 190, 0);">nacos<sup>1</sup></a><a href="/tags/redis/" style="font-size: 0.88rem; color: rgb(4, 60, 51);">redis<sup>1</sup></a><a href="/tags/%E7%94%9F%E6%B4%BB/" style="font-size: 0.88rem; color: rgb(35, 128, 183);">生活<sup>2</sup></a></div></div><hr></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button type="button" title="切换背景" onclick="toggleWinbox()"><i class="anzhiyufont anzhiyu-icon-images"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button><button id="go-down" type="button" title="直达底部" onclick="window.scrollTo({top: document.body.scrollHeight, behavior: 'smooth'})"><i class="anzhiyufont anzhiyu-icon-arrow-down"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/medium-zoom@1.1.0/dist/medium-zoom.min.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.cbd.int/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><canvas id="universe"></canvas><script async="" src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("04/01/2021 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2024 By 安知鱼 V1.6.12",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 violet 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async="" src="/anzhiyu/random.js"></script><script src="https://cdn.cbd.int/hexo-naokuo-search@0.0.2/dist/local-search.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script async="" data-pjax="" src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script defer="" src="/live2d-widget-master/autoload.js"></script><script src="https://cdn.jsdelivr.net/gh/nextapps-de/winbox/dist/winbox.bundle.min.js"></script><script src="/js/xxx.js?1"></script><script async="" src="https://npm.onmicrosoft.cn/naokuo-blog@1.2.10/js/SmoothScroll.min.js"></script><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script id="click-show-text" src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/click-show-text.min.js" data-mobile="true" data-text="富强,民主,文明,和谐,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="false" async="async"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async="" data-pjax="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div><!-- hexo injector body_end start --><script src="https://cdn.jsdelivr.net/npm/hexo-widget-tree@0.2.3/js/index.js"></script><style>#widget-tree-button{opacity:0}</style><div id="widget-tree">
      <ul>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/%E7%94%9F%E6%B4%BB/">
          生活
        </a>
      <span class="tree-list-count">2</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/e22607b1.html" title="词"><i class="post-icon gg-file-document"></i>词</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/1f44fecb.html" title="诗"><i class="post-icon gg-file-document"></i>诗</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/%E7%A8%8B%E5%BA%8F%E5%91%98/">
          程序员
        </a>
      <span class="tree-list-count">3</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/621998ca.html" title="Java架构师成长路径图"><i class="post-icon gg-file-document"></i>Java架构师成长路径图</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/1690d21b.html" title="函数式编程"><i class="post-icon gg-file-document"></i>函数式编程</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/6ed5eebe.html" title="SpringCloud微服务项目"><i class="post-icon gg-file-document"></i>SpringCloud微服务项目</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/%E5%B7%A5%E5%85%B7/">
          工具
        </a>
      <span class="tree-list-count">6</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/7f7493d0.html" title="IDEA 使用 Git 详解(一)"><i class="post-icon gg-file-document"></i>IDEA 使用 Git 详解(一)</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/c68db7e6.html" title="VsCode下载安装"><i class="post-icon gg-file-document"></i>VsCode下载安装</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/d06fc5d7.html" title="IDEA 使用 Git 详解(三)"><i class="post-icon gg-file-document"></i>IDEA 使用 Git 详解(三)</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/ae9ce5fc.html" title="IDEA 使用 Git 详解(二)"><i class="post-icon gg-file-document"></i>IDEA 使用 Git 详解(二)</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/545a6120.html" title="VMware"><i class="post-icon gg-file-document"></i>VMware</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/97a0a1c6.html" title="Idea下载安装"><i class="post-icon gg-file-document"></i>Idea下载安装</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/SpringCloud/">
          SpringCloud
        </a>
      <span class="tree-list-count">3</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/cd988ed5.html" title="Docker使用"><i class="post-icon gg-file-document"></i>Docker使用</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/f5f9fa9b.html" title="安装Docker"><i class="post-icon gg-file-document"></i>安装Docker</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/8af9e237.html" title="MybatisPlus"><i class="post-icon gg-file-document"></i>MybatisPlus</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">
          环境搭建
        </a>
      <span class="tree-list-count">4</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/f5f9fa9b.html" title="安装Docker"><i class="post-icon gg-file-document"></i>安装Docker</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/95afb97c.html" title="Nacos 安装与使用"><i class="post-icon gg-file-document"></i>Nacos 安装与使用</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/6b830637.html" title="Redis安装说明"><i class="post-icon gg-file-document"></i>Redis安装说明</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/386349fe.html" title="Git 安装与使用"><i class="post-icon gg-file-document"></i>Git 安装与使用</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E6%B3%95/">
          编程语法
        </a>
      <span class="tree-list-count">1</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/5d06cb2d.html" title="SQL使用教程"><i class="post-icon gg-file-document"></i>SQL使用教程</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6/">
          开发框架
        </a>
      <span class="tree-list-count">4</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/c5b41cb.html" title="SaToken鉴权框架-深入"><i class="post-icon gg-file-document"></i>SaToken鉴权框架-深入</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/fe850976.html" title="SaToken鉴权框架-基础"><i class="post-icon gg-file-document"></i>SaToken鉴权框架-基础</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/8af9e237.html" title="MybatisPlus"><i class="post-icon gg-file-document"></i>MybatisPlus</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/fe850976.html" title="SaToken鉴权框架"><i class="post-icon gg-file-document"></i>SaToken鉴权框架</a></li></ul></li></ul>
        <div id="widget-tree-button">
          <i class="gg-chevron-right"></i>
        </div>
      </div> <script data-pjax="">if(document.getElementById('recent-posts') && location.pathname =='/'){
    
    var parent = document.getElementById('recent-posts');
    var child = '<div class="recent-post" style="height: auto;width: 100%;position: relative;"> <div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container" style="top: 0;margin-bottom: 20px;"> <div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src="https://img1.baidu.com/it/u=3093179843,731129673&fm=253&fmt=auto&app=138&f=JPEG?w=952&h=500" alt="https://img1.baidu.com/it/u=3093179843,731129673&fm=253&fmt=auto&app=138&f=JPEG?w=952&h=500"/></div><div class="blog-slider__content"><span class="blog-slider__code">2024-09-02</span><a class="blog-slider__title" href="posts/4a17b156.html">Hello World</a><div class="blog-slider__text">简单好用的 hexo 博客！欢迎使用！</div><a class="blog-slider__button" href="posts/4a17b156.html">详情</a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src="https://www.javaweb.cc/zb_users/upload/editor/water/2022-12-01/63887b9fdbaf2.jpeg" alt="https://www.javaweb.cc/zb_users/upload/editor/water/2022-12-01/63887b9fdbaf2.jpeg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2024-09-23</span><a class="blog-slider__title" href="posts/621998ca.html">Java架构师成长路径图</a><div class="blog-slider__text">Java架构师成长路径图！</div><a class="blog-slider__button" href="posts/621998ca.html">详情</a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div> </div> </div>';
    console.log('已挂载swiper')
    parent.insertAdjacentHTML("afterbegin",child)}
     </script>
<script data-pjax="" src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-swiper/swiper/swiper.min.js"></script>
<script data-pjax="" src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-swiper@0.18/swiper/swiperindex.js"></script>
<style></style><!-- hexo injector body_end end -->
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: true,
                preloadRatio: 3,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>(r=>{r.imageLazyLoadSetting.processImages=t;var a=r.imageLazyLoadSetting.isSPA,o=r.imageLazyLoadSetting.preloadRatio||1,d=i();function i(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(t){(a||t)&&(d=i());for(var e,n=0;n<d.length;n++)0<=(e=(e=d[n]).getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(r.innerHeight*o||document.documentElement.clientHeight*o)&&(()=>{var t,e,a,o,i=d[n];e=function(){d=d.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).dataset.loaded||(t.hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(a=new Image,o=t.getAttribute("data-original"),a.onload=function(){t.src=o,t.removeAttribute("data-original"),t.setAttribute("data-loaded",!0),e&&e()},a.onerror=function(){t.removeAttribute("data-original"),t.setAttribute("data-loaded",!1),t.src=o},t.src!==o&&(a.src=o)))})()}function e(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",e),r.addEventListener("resize",e),r.addEventListener("orientationchange",e)})(this);</script></body></html>